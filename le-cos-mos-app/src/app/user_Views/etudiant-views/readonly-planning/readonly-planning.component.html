


    <div fxLayout="column" fxFlex="100" fxLayoutAlign="center start" id="rightWrp">
      <p> Planning
        {{ replaceUnderScore(groupLink!) }}
      </p>
      <div fxFlex="10" id="validateBtnWrp">

        <span>
          <img
            (click)="previousMonDay()"
            width="40vw"
            src="../../../../assets/images/arrow-left.svg"
            id="left"
          />
          <h2>Semaine du {{ week }}</h2>
          <img
            (click)="nextMonday()"
            width="40vw"
            src="../../../../assets/images/arrow-right.svg"
            id="right"
          />
        </span>
        <mat-form-field class="datePicker" [floatLabel]="'always'">
          <mat-label>Choisissez une semaine</mat-label>
          <div style="display: flex">
            <mat-date-range-input
              [dateFilter]="rangeFilter"
              [rangePicker]="picker"
            >
              <input
                disabled
                #date
                (dateChange)="getSelectedDate(date.value); date.value = ''"
                matStartDate
                placeholder="{{ week }}"
              />
              <input
                (dateChange)="dateEnd.value = ''"
                #dateEnd
                disabled
                matEndDate
                placeholder="{{ week2 }}"
              />
            </mat-date-range-input>

            <mat-datepicker-toggle
              matIconSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-date-range-picker
              [disabled]="false"
              #picker
            ></mat-date-range-picker>
          </div>
          <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
        </mat-form-field>
        <img
          style="margin-left: 1vw"
          [style]="{ width: touched ? '0' : '5vw' }"
          src="../../../../../assets/images/check-lg.svg"
        />
      </div>
      <div id="borderTableWrp" fxLayoutAlign="end center" fxFill>
        <table
          fxFlex="100"
          mat-table
          [dataSource]="dataSource"
          multiTemplateDataRows
        >
          <div
            class="example-list"
          >
            <ng-container
              *ngFor="let column of columnsToDisplay; index as day"
              matColumnDef="{{ column }}"
            >
              <div *ngIf="column == ' '">
                <td id="header" *matCellDef="let element; let i = dataIndex">
                  <div id="headerContentWrp">
                    <div id="headerheure">
                      {{ element }}
                    </div>

                    <div id="quartDheureList">
                      <div>{{ element.split("h")[0] }}:00</div>
                      <div>{{ element.split("h")[0] }}:15</div>
                      <div>{{ element.split("h")[0] }}:30</div>
                      <div>{{ element.split("h")[0] }}:45</div>
                    </div>
                  </div>
                </td>
              </div>
              <th *matHeaderCellDef>{{ column }}</th>

              <td
                (mouseleave)="isOut = !isOut"
                (mouseenter)="
                  heureIndex = i; dayIndex = day - 1; isOut = !isOut
                "
                *matCellDef="let i = dataIndex"
              >
                <div
                  class="rowDaysWrp"
                  *ngIf="
                   semaineJours[0][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[0][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[0][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[0][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[0][i][0][2] || semaineJours[0][i][1][2] || semaineJours[0][i][2][2] || semaineJours[0][i][3][2]"
                  >
                    <label> {{ semaineJours[0][i][0][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[0][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[0][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[0][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[0][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[0][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[0][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>

                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[0][i][1][6] == '15' ||
                        (semaineJours[0][i][1][6] == '00' &&
                          semaineJours[0][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[0][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[0][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[0][i][0][2] || semaineJours[0][i][1][2] || semaineJours[0][i][2][2] || semaineJours[0][i][3][2]"

                  >
                    <label> {{ semaineJours[0][i][1][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[0][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[0][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[0][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[0][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[0][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[0][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >
                    </mat-menu>
                  </div>

                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[0][i][2][6] == '30' ||
                        (semaineJours[0][i][2][6] == '15' &&
                          semaineJours[0][i][2][5] != '25') ||
                        (semaineJours[0][i][2][6] == '00' &&
                          semaineJours[0][i][2][5] != '25' &&
                          semaineJours[0][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[0][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[0][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[0][i][0][2] || semaineJours[0][i][1][2] || semaineJours[0][i][2][2] || semaineJours[0][i][3][2]"

                  >
                    <label> {{ semaineJours[0][i][2][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[0][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[0][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[0][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[0][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[0][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[0][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >
                    </mat-menu>
                  </div>

                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[0][i][3][6] == '30' &&
                          semaineJours[0][i][3][5] != '25') ||
                        semaineJours[0][i][3][6] == '45' ||
                        semaineJours[0][i][3][5] == '100' ||
                        (semaineJours[0][i][3][6] == '15' &&
                          (semaineJours[0][i][3][5] == '75' ||
                            semaineJours[0][i][3][5] == '100')) ||
                        (semaineJours[0][i][3][6] == '00' &&
                          semaineJours[0][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[0][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[0][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[0][i][0][2] || semaineJours[0][i][1][2] || semaineJours[0][i][2][2] || semaineJours[0][i][3][2]"

                  >
                    <label> {{ semaineJours[0][i][3][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[0][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[0][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[0][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[0][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[0][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[0][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >
                    </mat-menu>
                  </div>
                </div>

                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[1][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[1][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[1][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[1][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[1][i][0][2] || semaineJours[1][i][1][2] || semaineJours[1][i][2][2] || semaineJours[1][i][3][2]"

                  >
                    <label> {{ semaineJours[1][i][0][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[1][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[1][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[1][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[1][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[1][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[1][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >
                    </mat-menu>
                  </div>

                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[1][i][1][6] == '15' ||
                        (semaineJours[1][i][1][6] == '00' &&
                          semaineJours[1][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[1][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[1][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[1][i][0][2] || semaineJours[1][i][1][2] || semaineJours[1][i][2][2] || semaineJours[1][i][3][2]"

                  >
                    <label> {{ semaineJours[1][i][1][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[1][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[1][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[1][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[1][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[1][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[1][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >
                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[1][i][2][6] == '30' ||
                        (semaineJours[1][i][2][6] == '15' &&
                          semaineJours[1][i][2][5] != '25') ||
                        (semaineJours[1][i][2][6] == '00' &&
                          semaineJours[1][i][2][5] != '25' &&
                          semaineJours[1][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[1][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[1][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[1][i][0][2] || semaineJours[1][i][1][2] || semaineJours[1][i][2][2] || semaineJours[1][i][3][2]"

                  >
                    <label> {{ semaineJours[1][i][2][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[1][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[1][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[1][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[1][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[1][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[1][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[1][i][3][6] == '30' &&
                          semaineJours[1][i][3][5] != '25') ||
                        semaineJours[1][i][3][6] == '45' ||
                        semaineJours[1][i][3][5] == '100' ||
                        (semaineJours[1][i][3][6] == '15' &&
                          (semaineJours[1][i][3][5] == '75' ||
                            semaineJours[1][i][3][5] == '100')) ||
                        (semaineJours[1][i][3][6] == '00' &&
                          semaineJours[1][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[1][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[1][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[1][i][0][2] || semaineJours[1][i][1][2] || semaineJours[1][i][2][2] || semaineJours[1][i][3][2]"

                  >
                    <label> {{ semaineJours[1][i][3][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[1][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[1][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[1][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[1][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[1][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[1][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >


                    </mat-menu>
                  </div>
                </div>

                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[2][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[2][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[2][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[2][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[2][i][0][2] || semaineJours[2][i][1][2] || semaineJours[2][i][2][2] || semaineJours[2][i][3][2]"

                  >
                    <label> {{ semaineJours[2][i][0][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[2][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[2][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[2][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[2][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[2][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[2][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[2][i][1][6] == '15' ||
                        (semaineJours[2][i][1][6] == '00' &&
                          semaineJours[2][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[2][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[2][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[2][i][0][2] || semaineJours[2][i][1][2] || semaineJours[2][i][2][2] || semaineJours[2][i][3][2]"

                  >
                    <label> {{ semaineJours[2][i][1][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[2][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[2][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[2][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[2][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[2][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[2][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[2][i][2][6] == '30' ||
                        (semaineJours[2][i][2][6] == '15' &&
                          semaineJours[2][i][2][5] != '25') ||
                        (semaineJours[2][i][2][6] == '00' &&
                          semaineJours[2][i][2][5] != '25' &&
                          semaineJours[2][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[2][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[2][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[2][i][0][2] || semaineJours[2][i][1][2] || semaineJours[2][i][2][2] || semaineJours[2][i][3][2]"

                  >
                    <label> {{ semaineJours[2][i][2][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[2][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[2][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[2][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[2][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[2][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[2][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[2][i][3][6] == '30' &&
                          semaineJours[2][i][3][5] != '25') ||
                        semaineJours[2][i][3][6] == '45' ||
                        semaineJours[2][i][3][5] == '100' ||
                        (semaineJours[2][i][3][6] == '15' &&
                          (semaineJours[2][i][3][5] == '75' ||
                            semaineJours[2][i][3][5] == '100')) ||
                        (semaineJours[2][i][3][6] == '00' &&
                          semaineJours[2][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[2][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[2][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[2][i][0][2] || semaineJours[2][i][1][2] || semaineJours[2][i][2][2] || semaineJours[2][i][3][2]"

                  >
                    <label> {{ semaineJours[2][i][3][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[2][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[2][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[2][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[2][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[2][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[2][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                </div>

                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[3][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[3][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[3][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[3][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[3][i][0][2] || semaineJours[3][i][1][2] || semaineJours[3][i][2][2] || semaineJours[3][i][3][2]"
                  >
                    <label> {{ semaineJours[3][i][0][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[3][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[3][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[3][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[3][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[3][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[3][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[3][i][1][6] == '15' ||
                        (semaineJours[3][i][1][6] == '00' &&
                          semaineJours[3][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[3][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[3][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[3][i][0][2] || semaineJours[3][i][1][2] || semaineJours[3][i][2][2] || semaineJours[3][i][3][2]"
                  >
                    <label> {{ semaineJours[3][i][1][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[3][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[3][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[3][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[3][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[3][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[3][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[3][i][2][6] == '30' ||
                        (semaineJours[3][i][2][6] == '15' &&
                          semaineJours[3][i][2][5] != '25') ||
                        (semaineJours[3][i][2][6] == '00' &&
                          semaineJours[3][i][2][5] != '25' &&
                          semaineJours[3][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[3][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[3][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[3][i][0][2] || semaineJours[3][i][1][2] || semaineJours[3][i][2][2] || semaineJours[3][i][3][2]"

                  >
                    <label> {{ semaineJours[3][i][2][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[3][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[3][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[3][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[3][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[3][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[3][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[3][i][3][6] == '30' &&
                          semaineJours[3][i][3][5] != '25') ||
                        semaineJours[3][i][3][6] == '45' ||
                        semaineJours[3][i][3][5] == '100' ||
                        (semaineJours[3][i][3][6] == '15' &&
                          (semaineJours[3][i][3][5] == '75' ||
                            semaineJours[3][i][3][5] == '100')) ||
                        (semaineJours[3][i][3][6] == '00' &&
                          semaineJours[3][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[3][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[3][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[3][i][0][2] || semaineJours[3][i][1][2] || semaineJours[3][i][2][2] || semaineJours[3][i][3][2]"

                  >
                    <label> {{ semaineJours[3][i][3][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[3][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[3][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[3][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[3][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[3][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[3][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                </div>

                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[4][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[4][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[4][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[4][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[4][i][0][2] || semaineJours[4][i][1][2] || semaineJours[4][i][2][2] || semaineJours[4][i][3][2]"

                  >
                    <label> {{ semaineJours[4][i][0][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[4][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[4][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[4][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[4][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[4][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[4][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >


                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[4][i][1][6] == '15' ||
                        (semaineJours[4][i][1][6] == '00' &&
                          semaineJours[4][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[4][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[4][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[4][i][0][2] || semaineJours[4][i][1][2] || semaineJours[4][i][2][2] || semaineJours[4][i][3][2]"

                  >
                    <label> {{ semaineJours[4][i][1][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[4][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[4][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[4][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[4][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[4][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[4][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[4][i][2][6] == '30' ||
                        (semaineJours[4][i][2][6] == '15' &&
                          semaineJours[4][i][2][5] != '25') ||
                        (semaineJours[4][i][2][6] == '00' &&
                          semaineJours[4][i][2][5] != '25' &&
                          semaineJours[4][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[4][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[4][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[4][i][0][2] || semaineJours[4][i][1][2] || semaineJours[4][i][2][2] || semaineJours[4][i][3][2]"

                  >
                    <label> {{ semaineJours[4][i][2][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[4][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[4][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[4][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[4][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[4][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[4][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[4][i][3][6] == '30' &&
                          semaineJours[4][i][3][5] != '25') ||
                        semaineJours[4][i][3][6] == '45' ||
                        semaineJours[4][i][3][5] == '100' ||
                        (semaineJours[4][i][3][6] == '15' &&
                          (semaineJours[4][i][3][5] == '75' ||
                            semaineJours[4][i][3][5] == '100')) ||
                        (semaineJours[4][i][3][6] == '00' &&
                          semaineJours[4][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[4][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[4][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[4][i][0][2] || semaineJours[4][i][1][2] || semaineJours[4][i][2][2] || semaineJours[4][i][3][2]"

                  >
                    <label> {{ semaineJours[4][i][3][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[4][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[4][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[4][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[4][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[4][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[4][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                </div>

                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[5][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[5][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[5][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[5][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[5][i][0][2] || semaineJours[5][i][1][2] || semaineJours[5][i][2][2] || semaineJours[5][i][3][2]"

                  >
                    <label> {{ semaineJours[5][i][0][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[5][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[5][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[5][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[5][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[5][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[5][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[5][i][1][6] == '15' ||
                        (semaineJours[5][i][1][6] == '00' &&
                          semaineJours[5][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[5][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[5][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[5][i][0][2] || semaineJours[5][i][1][2] || semaineJours[5][i][2][2] || semaineJours[5][i][3][2]"

                  >
                    <label> {{ semaineJours[5][i][1][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[5][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[5][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[5][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[5][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[5][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[5][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[5][i][2][6] == '30' ||
                        (semaineJours[5][i][2][6] == '15' &&
                          semaineJours[5][i][2][5] != '25') ||
                        (semaineJours[5][i][2][6] == '00' &&
                          semaineJours[5][i][2][5] != '25' &&
                          semaineJours[5][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[5][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[5][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[5][i][0][2] || semaineJours[5][i][1][2] || semaineJours[5][i][2][2] || semaineJours[5][i][3][2]"

                  >
                    <label> {{ semaineJours[5][i][2][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[5][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[5][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[5][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[5][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[5][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[5][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[5][i][3][6] == '30' &&
                          semaineJours[5][i][3][5] != '25') ||
                        semaineJours[5][i][3][6] == '45' ||
                        semaineJours[5][i][3][5] == '100' ||
                        (semaineJours[5][i][3][6] == '15' &&
                          (semaineJours[5][i][3][5] == '75' ||
                            semaineJours[5][i][3][5] == '100')) ||
                        (semaineJours[5][i][3][6] == '00' &&
                          semaineJours[5][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[5][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[5][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[5][i][0][2] || semaineJours[5][i][1][2] || semaineJours[5][i][2][2] || semaineJours[5][i][3][2]"

                  >
                    <label> {{ semaineJours[5][i][3][2] }}</label>
                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[5][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[5][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[5][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[5][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[5][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[5][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                </div>
                <div
                  class="rowDaysWrp"
                  *ngIf="
                    semaineJours[6][i][0][3] == column
                  "
                >
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 0"
                    [style]="{
                      'background-color':
                        semaineJours[6][i][0][6] == '00'
                          ? getBackgroundColor(semaineJours[6][i][0][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[6][i][0][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-00"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[6][i][0][2] || semaineJours[6][i][1][2] || semaineJours[6][i][2][2] || semaineJours[6][i][3][2]"

                  >
                    <label> {{ semaineJours[6][i][0][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[6][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[6][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[6][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[6][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[6][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[6][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 1"
                    [style]="{
                      'background-color':
                        semaineJours[6][i][1][6] == '15' ||
                        (semaineJours[6][i][1][6] == '00' &&
                          semaineJours[6][i][1][5] != '25')
                          ? getBackgroundColor(semaineJours[6][i][1][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[6][i][1][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-15"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[6][i][0][2] || semaineJours[6][i][1][2] || semaineJours[6][i][2][2] || semaineJours[6][i][3][2]"

                  >
                    <label> {{ semaineJours[6][i][1][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[6][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[6][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[6][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[6][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[6][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[6][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 2"
                    [style]="{
                      'background-color':
                        semaineJours[6][i][2][6] == '30' ||
                        (semaineJours[6][i][2][6] == '15' &&
                          semaineJours[6][i][2][5] != '25') ||
                        (semaineJours[6][i][2][6] == '00' &&
                          semaineJours[6][i][2][5] != '25' &&
                          semaineJours[6][i][2][5] != '50')
                          ? getBackgroundColor(semaineJours[6][i][2][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[6][i][2][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-30"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[6][i][0][2] || semaineJours[6][i][1][2] || semaineJours[6][i][2][2] || semaineJours[6][i][3][2]"

                  >
                    <label> {{ semaineJours[6][i][2][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[6][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[6][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[6][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[6][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[6][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[6][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                  <div
                  [matMenuTriggerFor]="menu"
                    (mouseenter)="creneauIndex = 3"
                    [style]="{
                      'background-color':
                        (semaineJours[6][i][3][6] == '30' &&
                          semaineJours[6][i][3][5] != '25') ||
                        semaineJours[6][i][3][6] == '45' ||
                        semaineJours[6][i][3][5] == '100' ||
                        (semaineJours[6][i][3][6] == '15' &&
                          (semaineJours[6][i][3][5] == '75' ||
                            semaineJours[6][i][3][5] == '100')) ||
                        (semaineJours[6][i][3][6] == '00' &&
                          semaineJours[6][i][3][5] == '100')
                          ? getBackgroundColor(semaineJours[6][i][3][2])
                          : 'transparent',
                      color: getTextColor(semaineJours[6][i][3][2]),
                      'min-height': isExpanded ? '25%' : 'calc(5vh / 4)'
                    }"
                    id="t-45"
                    *ngIf="(isOnDrag && (heureIndex == i)) || semaineJours[6][i][0][2] || semaineJours[6][i][1][2] || semaineJours[6][i][2][2] || semaineJours[6][i][3][2]"

                  >
                    <label> {{ semaineJours[6][i][3][2] }}</label>

                    <mat-menu
                      style="cursor: pointer; text-align: center"
                      #menu="matMenu"
                    >
                      <mat-label mat-menu-item
                        >Type de séance :
                        {{
                          semaineJours[6][i][creneauIndex][2] ||
                            "Aucun type n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Salle :
                        {{
                          semaineJours[6][i][creneauIndex][4] ||
                            "Aucune salle n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Matière :
                        {{
                          semaineJours[6][i][creneauIndex][1] ||
                            "Aucune matière n'est associée"
                        }}</mat-label
                      >
                      <mat-label mat-menu-item
                        >Durée :
                        {{
                          semaineJours[6][i][creneauIndex][5] == "25"
                            ? "15m"
                            : semaineJours[6][i][creneauIndex][5] == "50"
                            ? "30m"
                            : semaineJours[6][i][creneauIndex][5] == "75"
                            ? "45m"
                            : "60m"
                        }}</mat-label
                      >

                    </mat-menu>
                  </div>
                </div>
              </td>
            </ng-container>
          </div>

          <tr
            class="header-row"
            mat-header-row
            *matHeaderRowDef="columnsToDisplay"
          ></tr>
          <tr
            class="row"
            mat-row
            *matRowDef="let row; columns: columnsToDisplay"
          ></tr>
        </table>
      </div>
    </div>

